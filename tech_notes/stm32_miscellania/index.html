<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Émilie Gillet" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Stm32 miscellania - Mutable Instruments Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Stm32 miscellania";
        var mkdocs_page_input_path = "tech_notes/stm32_miscellania.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Mutable Instruments Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Modules</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="#">Beads</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/beads/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/beads/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/beads/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Blades</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/blades/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/blades/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/blades/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/blades/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Blinds</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/blinds/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/blinds/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/blinds/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/blinds/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Braids</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/braids/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/braids/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/braids/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/braids/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/braids/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/braids/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Branches</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/branches/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/branches/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/branches/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/branches/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/branches/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Clouds</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/clouds/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/clouds/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/clouds/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/clouds/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/clouds/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/clouds/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Ears</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ears/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ears/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ears/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ears/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Edges</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/edges/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/edges/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/edges/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/edges/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/edges/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Elements</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/elements/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/elements/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/elements/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/elements/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/elements/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/elements/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Frames</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/frames/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/frames/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/frames/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/frames/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/frames/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/frames/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Grids</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/grids/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/grids/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/grids/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/grids/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/grids/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Kinks</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/kinks/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/kinks/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/kinks/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/kinks/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Links</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/links/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/links/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/links/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/links/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Marbles</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/marbles/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/marbles/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/marbles/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/marbles/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/marbles/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/marbles/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Peaks</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/peaks/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/peaks/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/peaks/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/peaks/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/peaks/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/peaks/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Plaits</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/plaits/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/plaits/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/plaits/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/plaits/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/plaits/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Rings</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/rings/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/rings/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/rings/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/rings/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/rings/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/rings/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Ripples 2020</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ripples_2020/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ripples_2020/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ripples_2020/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ripples_2020/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Ripples original</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ripples_original/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ripples_original/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ripples_original/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/ripples_original/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Shades 2020</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shades_2020/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shades_2020/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shades_2020/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shades_2020/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Shades original</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shades_original/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shades_original/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shades_original/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shades_original/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Shelves</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shelves/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shelves/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shelves/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/shelves/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Stages</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/stages/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/stages/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/stages/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/stages/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/stages/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/stages/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Streams</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/streams/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/streams/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/streams/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/streams/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/streams/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/streams/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Tides 2018</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/tides_2018/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/tides_2018/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/tides_2018/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/tides_2018/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/tides_2018/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Tides original</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/tides_original/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/tides_original/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/tides_original/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/tides_original/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/tides_original/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/tides_original/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Veils 2020</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/veils_2020/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/veils_2020/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/veils_2020/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/veils_2020/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Veils original</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/veils_original/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/veils_original/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/veils_original/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/veils_original/original_blurb/">Original blurb</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Warps</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/warps/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/warps/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/warps/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/warps/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/warps/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/warps/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Yarns</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/yarns/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/yarns/firmware/">Firmware</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/yarns/manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/yarns/open_source/">Open source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/yarns/original_blurb/">Original blurb</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/yarns/secrets/">Secrets</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tech notes</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../avr_miscellania/">Avr miscellania</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../clock_processing_with_ramps/">Clock processing with ramps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../coding_miscellania/">Coding miscellania</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cv_inputs/">Cv inputs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dco_vs_digital_oscillator/">Dco vs digital oscillator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../designing_pcb_panels/">Designing pcb panels</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../education/">Education</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../emc_certification_process/">Emc certification process</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../exponential_conversion_in_digital_oscillators/">Exponential conversion in digital oscillators</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../four_quadrant_multiplication_with_a_vca/">Four quadrant multiplication with a vca</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hardware_miscellania/">Hardware miscellania</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../interfacing_with_converters/">Interfacing with converters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../life_of_a_cvpal_midi_note/">Life of a cvpal midi note</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../life_of_an_audio_buffer/">Life of an audio buffer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../speech_synthesis_algorithms/">Speech synthesis algorithms</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Stm32 miscellania</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#why-not-dsps">Why not DSPs?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#why-arm-mcus">Why ARM MCUs?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#why-stm32">Why STM32?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#which-mcus">Which MCUs?</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../switches/">Switches</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../timing_and_processes/">Timing and processes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../why_did_color_knobs_disappear/">Why did color knobs disappear</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Third party firmware</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../third_party_firmware/">Index</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Trivia and history</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../trivia_and_history/beads_history/">Beads history</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../trivia_and_history/cancelled_projects/">Cancelled projects</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../trivia_and_history/clouds_history/">Clouds history</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Mutable Instruments Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Tech notes &raquo;</li>
      <li>Stm32 miscellania</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="history-time-why-stm32-chips">History time: why STM32 chips?</h2>
<h3 id="why-not-dsps">Why not DSPs?</h3>
<ul>
<li>DSPs require proprietary, often expensive, development tools running on Windows.</li>
<li>DSPs often require external memory chips.</li>
<li>DSPs often come in large packages.</li>
<li>The code written for DSPs is not portable and is often write only. The development cycle (prototype in a higher level language, then port to assembly, then it's over) is not my preferred way of working because I like revising ideas, and running the code on my development machine to experiment with it rather than on the embedded target. Think of it: VCV Rack wouldn't have been possible if Rings ran DSP code.</li>
</ul>
<h3 id="why-arm-mcus">Why ARM MCUs?</h3>
<p>There are open source development tools like openOCD and gcc. The fact that ARM is the most popular platform for smartphones and IoT devices means that there is a large community, including employees from large companies, maintaining and improving gcc for the ARM target, and that the generated code and the optimizations are good.</p>
<h3 id="why-stm32">Why STM32?</h3>
<p>At the time I got into it in 2012, there were two choices: STM32F and NXP LPC (I'm not even sure Freescale Kinetis was available, but if it was it wasn't very visible). STM32 had better support from the open source tools, and more importantly the embedded systems class at my alma mater used them. I could get access to their course material, so that's what I went with.</p>
<p>In a nutshell, it could be summarized by the fact that I come from a software development background using UNIX command line tools, and that I wanted to keep a similar workflow when developing my modules. If I had come from an embedded systems or more generally EE background, I wouldn't have shied away from a proprietary IDE running on Windows and might have gone for something else.</p>
<p>Another large DIY project, MIDIBox, was mostly STM32F at the time; and with the popularity of Mutable Instruments and the availability of the schematics, code and makefiles, I suspect this might have influenced many aspiring developers to get into this platform in the following years.</p>
<h3 id="which-mcus">Which MCUs?</h3>
<p>There are three "classes" in terms of CPU use, and Peaks and Plaits are in the same:</p>
<ul>
<li>Heavy: Beads (STM32H7, 480 MHz)</li>
<li>Medium: Rings, Warps, Clouds, Elements, Marbles (STM32F405, 168 MHz)</li>
<li>Light: Peaks, Yarns, Tides, Frames (STM32F10x, 72 MHz, integer math), Plaits, Stages, Tides 2018 (STM32F37x, 72 MHz, floating point math)</li>
</ul>
<p>Pretty much all modules are designed to use 80 to 95% of the available computing power on the chip. I tweak the sample rate and/or adjust the complexity of the code (order of interpolations, number of voices, that kind of things...) to reach that goal.</p>
<p>In 2021 I would have probably used the STM32G4 line for all modules other than Beads! But then there is... chronology. When I designed Rings in 2015, I had no idea a better choice of MCU would come 4 years later (and if I knew about it, would I have waited for it to be available)?</p>
<p>There was no other choice than the F4 at that time. But how awful the ADCs are on that MCU! You need a lot of post-processing to get a stable and accurate reading.</p>
<p>Then ST launched the F37x line. This was an interesting proposition: you get less CPU power than the F4, but excellent ADCs. The F37x looked like the perfect choice to upgrade modules which were not inherently CPU hungry: Braids (-&gt; Plaits), Peaks (-&gt; Stages), and Tides.</p>
<p>With the G4 line, there is no longer any compromise to do on CPU vs ADC precision. And given that they are available in 48 pin packages, they are suitable for small modules (like Plaits).</p>
<h2 id="flash-layout-and-bootloader">FLASH layout and bootloader</h2>
<p>The bootloader is compiled and linked with a linkerscript that places the interrupt vector and code at <a href="https://github.com/pichenettes/stmlib/blob/f8a4b46b7abb5d752a6a72932eeac1a03fe958fd/linker_scripts/stm32f10x_flash_cl.ld#L7">0x08000000</a> (beginning of flash).</p>
<p>The application code is compiled and linked with a different linkerscript that places the interrupt vector and code at <a href="https://github.com/pichenettes/stmlib/blob/f8a4b46b7abb5d752a6a72932eeac1a03fe958fd/linker_scripts/stm32f10x_flash_cl_application.ld#L7">0x08004000</a> (16k after the beginning of the flash)</p>
<p>Both blocks of code are converted to .hex files and <a href="https://github.com/pichenettes/stmlib/blob/f8a4b46b7abb5d752a6a72932eeac1a03fe958fd/makefile.inc#L327">merged together</a> in a single .hex file - so effectively the first 16k of flash contains the bootloader, and the rest the application code.</p>
<p>When the module is powered on, the processor boots with the interrupt vector and code at 0x08000000, so it starts running the <a href="https://github.com/pichenettes/eurorack/blob/master/braids/bootloader/bootloader.cc#L172">bootloader code</a>. It either stays there if the encoder is pressed; or it leaves the <code>white (!exit_updater)</code> loop. In which case, the <a href="https://github.com/pichenettes/eurorack/blob/master/braids/bootloader/bootloader.cc#L228">processor is reset and the program counter is forced to address 0x08004000</a>, so it jumps to the main <a href="https://github.com/pichenettes/eurorack/blob/master/braids/braids.cc#L299">application code</a>. One of the very first things done in the application code is <a href="https://github.com/pichenettes/eurorack/blob/master/braids/drivers/system.cc#L36">to set the interrupt vector table to 0x4000</a> - so that it doesn't use the interrupt table at the beginning of the flash.</p>
<h2 id="why-plaits-does-not-run-at-48khz-exactly">Why Plaits does not run at 48kHz exactly</h2>
<p>PLL setting: 9/47.</p>
<p>Actual sample rate: 8000000 x 9/47 / 16 / 2 / 48000 = 47872.34 Hz</p>
<h2 id="low-level-pin-access">Low-level pin access</h2>
<pre><code>    // For F1, F3, G4
    GPIOA-&gt;BSRR = GPIO_Pin_0; // Set Pin 0 of GPIOA high
    GPIOA-&gt;BRR = GPIO_Pin_0; // Set Pin 0 of GPIOA low

    // For F4
    GPIOA-&gt;BSRRL = GPIO_Pin_0; // Set Pin 0 of GPIOA high
    GPIOA-&gt;BSRRH = GPIO_Pin_0; // Set Pin 0 of GPIOA low

    // For H7
    GPIOA-&gt;BSRR = GPIO_Pin_0; // Set Pin 0 of GPIOA high
    GPIOA-&gt;BSRR = GPIO_Pin_0 &lt;&lt; 16U; // Set Pin 0 of GPIOA low
</code></pre>
<h2 id="why-no-equivalent-of-avril-for-stm32">Why no equivalent of avril for STM32?</h2>
<p><code>avril</code> was Mutable Instruments' hardware abstraction library for the AVR family, heavily based on C++ templates.</p>
<p>When I started programming on AVR, the two alternatives were either direct register writes (unreadable without the AVR datasheet) or the Arduino libraries (poorly designed, run-time abstractions with huge overhead for every call). I really felt the need for something that would allow me to write readable/reusable code... that could be compiled down to a single machine instruction. It was very important because I knew the projects I was working on were pushing the processor to its limits in terms of CPU use and code size. I also knew I would frequently have to do bit-banging.</p>
<p>The need for a such a library was less pressing when I moved to STM32F. First, the "firmware library" from ST covered relatively well the need for an abstraction layer above raw register writes. It's not very efficient (overhead of function calls), but I don't need it to be very efficient because most I/O occurs at a low rate (usually 1kHz), and the stuff that occurs at a higher rate is usually controlled by the hardware (DMA, specialized peripherals...). Also, the chips are more generous in terms of flash size, so less efficient code is tolerated. And another thing I learnt from my AVR days: all projects have something unique on the hardware side that makes it a bit futile to write a reusable library above the GPIO level.</p>
<p>There are still places where I use templates in the new projects, though!</p>
<p>For example, Clouds' <a href="https://github.com/pichenettes/eurorack/blob/master/clouds/dsp/grain.h#L120">grain rendering algorithm</a> is specialized for each combinations of channel #, audio quality, and sample interpolation method - removing as much tests and branching from the loop, and keeping the inside of the loop small enough for the compiler to unroll.</p>
<p>Another example is the <a href="https://github.com/pichenettes/stmlib/blob/master/dsp/filter.h#L190">multimode filter</a> used in Clouds and Elements, in which the filter type is a compile-time parameter.</p>
<p>And Warps uses template-based polyphase FIR resamplers - the templates are used to unroll pretty much all the code at compile-time to make it very efficient.</p>
<p>The idea is that if a function <code>f(argument, parameter)</code> is called for only a few values of the parameter known at run-time, it might help performance (at the expense of code size) to create for each used value of the parameter a <code>f(argument)</code> variant in which the parameter is a known constant, and everything depending on the parameter can be pre-computed and assumed constant too (including all branches depending on the parameter being straightened). In other words: split the arguments of the function between “data” arguments and “configuration” arguments, and partially evaluate the “configuration” arguments at compile-time.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../speech_synthesis_algorithms/" class="btn btn-neutral float-left" title="Speech synthesis algorithms"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../switches/" class="btn btn-neutral float-right" title="Switches">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../speech_synthesis_algorithms/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../switches/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
